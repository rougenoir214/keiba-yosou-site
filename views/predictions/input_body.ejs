        <!-- Âç∞ÂÖ•Âäõ„Çª„ÇØ„Ç∑„Éß„É≥ -->
        <div class="section">
            <h2>üéØ Âç∞„ÇíÂÖ•Âäõ</h2>
            <form id="marks-form">
                <table>
                    <thead>
                        <tr>
                            <th>Êû†</th>
                            <th>È¶¨Áï™</th>
                            <th>È¶¨Âêç</th>
                            <th>È®éÊâã</th>
                            <th>Âç∞</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% 
                        const existingMarks = {};
                        predictions.forEach(p => {
                            existingMarks[p.umaban] = p.mark;
                        });
                        %>
                        <% horses.forEach(horse => { %>
                            <tr>
                                <td>
                                    <div class="waku waku-<%= horse.waku %>">
                                        <%= horse.waku %>
                                    </div>
                                </td>
                                <td><strong><%= horse.umaban %></strong></td>
                                <td><%= horse.horse_name %></td>
                                <td><%= horse.jockey %></td>
                                <td>
                                    <select name="mark_<%= horse.umaban %>" class="mark-select">
                                        <option value="">-</option>
                                        <option value="‚óé" <%= existingMarks[horse.umaban] === '‚óé' ? 'selected' : '' %>>‚óé</option>
                                        <option value="‚óã" <%= existingMarks[horse.umaban] === '‚óã' ? 'selected' : '' %>>‚óã</option>
                                        <option value="‚ñ≤" <%= existingMarks[horse.umaban] === '‚ñ≤' ? 'selected' : '' %>>‚ñ≤</option>
                                        <option value="‚ñ≥" <%= existingMarks[horse.umaban] === '‚ñ≥' ? 'selected' : '' %>>‚ñ≥</option>
                                        <option value="‚òÜ" <%= existingMarks[horse.umaban] === '‚òÜ' ? 'selected' : '' %>>‚òÜ</option>
                                    </select>
                                </td>
                            </tr>
                        <% }); %>
                    </tbody>
                </table>
                <button type="submit" class="btn btn-success" style="margin-top: 15px;">Âç∞„Çí‰øùÂ≠ò</button>
            </form>
        </div>

        <!-- È¶¨Âà∏Ë≥ºÂÖ•„Çª„ÇØ„Ç∑„Éß„É≥ -->
        <div class="section">
            <h2>üí∞ È¶¨Âà∏„ÇíË≥ºÂÖ•</h2>
            <form id="bet-form">
                <div class="form-group">
                    <label for="bet_type">È¶¨Âà∏Á®ÆÂà•</label>
                    <select id="bet_type" name="bet_type" required onchange="updateHorseSelection()">
                        <option value="tansho">ÂçòÂãù</option>
                        <option value="fukusho">Ë§áÂãù</option>
                        <option value="umaren">È¶¨ÈÄ£</option>
                        <option value="umatan">È¶¨Âçò</option>
                        <option value="wide">„ÉØ„Ç§„Éâ</option>
                        <option value="sanrenpuku">3ÈÄ£Ë§á</option>
                        <option value="sanrentan">3ÈÄ£Âçò</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>È¶¨„ÇíÈÅ∏Êäû</label>
                    <div id="horse-selection-info" style="color: #888; font-size: 14px; margin-bottom: 10px;">
                        ÂçòÂãù„ÉªË§áÂãù: 1È†≠ÈÅ∏Êäû
                    </div>
                    <div id="horse-checkboxes" style="max-height: 300px; overflow-y: auto; border: 1px solid #e0e0e0; padding: 10px; border-radius: 5px; background: #f9f9f9;">
                        <% horses.forEach(horse => { %>
                            <label style="display: block; padding: 8px; margin: 5px 0; background: white; border-radius: 5px; cursor: pointer; border: 2px solid transparent;" class="horse-checkbox-label">
                                <input type="checkbox" name="horse_check" value="<%= horse.umaban %>" 
                                       style="margin-right: 10px;" onchange="updateSelectedHorses()">
                                <span class="waku waku-<%= horse.waku %>" style="display: inline-block; width: 25px; height: 25px; line-height: 25px; text-align: center; border-radius: 3px; margin-right: 8px; font-size: 12px;"><%= horse.waku %></span>
                                <strong style="display: inline-block; width: 30px;"><%= horse.umaban %></strong>
                                <strong><%= horse.horse_name %></strong>
                                <span style="color: #888; margin-left: 10px;"><%= horse.jockey %></span>
                            </label>
                        <% }); %>
                    </div>
                    <input type="hidden" id="horses_input" name="horses" required>
                    <div id="selected-horses-display" style="margin-top: 10px; padding: 10px; background: #e8f5e9; border-radius: 5px; min-height: 40px;">
                        <strong>ÈÅ∏Êäû‰∏≠:</strong> <span id="selected-horses-text">„Å™„Åó</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="amount">ÈáëÈ°çÔºàÂÜÜÔºâ</label>
                    <input type="number" id="amount" name="amount" 
                           min="100" step="100" value="100" required>
                </div>
                
                <button type="submit" class="btn">È¶¨Âà∏„ÇíËøΩÂä†</button>
            </form>
        </div>

        <!-- Ë≥ºÂÖ•Ê∏à„ÅøÈ¶¨Âà∏‰∏ÄË¶ß -->
        <div class="section">
            <h2>üé´ Ë≥ºÂÖ•Ê∏à„ÅøÈ¶¨Âà∏</h2>
            <ul class="bet-list" id="bet-list">
                <% if (bets.length === 0) { %>
                    <p style="color: #888;">„Åæ„Å†È¶¨Âà∏„ÇíË≥ºÂÖ•„Åó„Å¶„ÅÑ„Åæ„Åõ„Çì</p>
                <% } else { %>
                    <% 
                    const betTypeNames = {
                        'tansho': 'ÂçòÂãù',
                        'fukusho': 'Ë§áÂãù',
                        'umaren': 'È¶¨ÈÄ£',
                        'umatan': 'È¶¨Âçò',
                        'wide': '„ÉØ„Ç§„Éâ',
                        'sanrenpuku': '3ÈÄ£Ë§á',
                        'sanrentan': '3ÈÄ£Âçò'
                    };
                    let totalAmount = 0;
                    %>
                    <% bets.forEach(bet => { 
                        totalAmount += bet.amount;
                    %>
                        <li class="bet-item">
                            <div class="bet-info">
                                <strong><%= betTypeNames[bet.bet_type] %></strong>: 
                                <%= bet.horses %> - <%= bet.amount.toLocaleString() %>ÂÜÜ
                            </div>
                            <button class="btn btn-danger" onclick="deleteBet(<%= bet.id %>)">ÂâäÈô§</button>
                        </li>
                    <% }); %>
                    <div class="total-amount">
                        ÂêàË®à: <span id="total-amount"><%= totalAmount.toLocaleString() %></span>ÂÜÜ
                    </div>
                    <div class="remaining-amount" id="remaining-amount">
                        ÊÆã„Çä: <%= (10000 - totalAmount).toLocaleString() %>ÂÜÜ
                    </div>
                <% } %>
            </ul>
        </div>
    </div>
