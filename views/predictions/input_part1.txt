<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‰∫àÊÉ≥ÂÖ•Âäõ - <%= race.race_name %></title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
.container { max-width: 1200px; margin: 0 auto; }
.header { background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
.header h1 { color: #333; margin-bottom: 10px; }
.back-link { display: inline-block; margin-top: 10px; color: #667eea; text-decoration: none; }
.back-link:hover { text-decoration: underline; }
.section { background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
.section h2 { color: #333; margin-bottom: 15px; border-bottom: 2px solid #667eea; padding-bottom: 10px; }
table { width: 100%; border-collapse: collapse; }
th { background: #667eea; color: white; padding: 12px; text-align: left; }
td { padding: 12px; border-bottom: 1px solid #eee; }
.mark-select { padding: 8px; border: 2px solid #e0e0e0; border-radius: 5px; font-size: 16px; }
.waku { width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; color: white; }
.waku-1 { background: white; color: #333; border: 2px solid #333; }
.waku-2 { background: black; }
.waku-3 { background: red; }
.waku-4 { background: blue; }
.waku-5 { background: yellow; color: #333; }
.waku-6 { background: green; }
.waku-7 { background: orange; }
.waku-8 { background: pink; color: #333; }
.btn { padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 14px; }
.btn:hover { background: #5568d3; }
.btn-success { background: #4caf50; }
.btn-success:hover { background: #45a049; }
.btn-danger { background: #f44336; }
.btn-danger:hover { background: #da190b; }
.form-group { margin-bottom: 15px; }
.form-group label { display: block; margin-bottom: 5px; font-weight: 600; color: #555; }
.form-group select, .form-group input { width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 5px; }
.bet-list { list-style: none; }
.bet-item { background: #f5f5f5; padding: 15px; border-radius: 5px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
.bet-info { flex: 1; }
.total-amount { font-size: 20px; font-weight: bold; color: #667eea; margin-top: 15px; }
.remaining-amount { color: #4caf50; margin-top: 5px; }
.horse-checkboxes { max-height: 300px; overflow-y: auto; border: 1px solid #e0e0e0; padding: 10px; border-radius: 5px; background: #f9f9f9; }
.horse-checkbox-label { display: block; padding: 8px; margin: 5px 0; background: white; border-radius: 5px; cursor: pointer; border: 2px solid transparent; transition: all 0.2s; }
.horse-checkbox-label:hover { background: #f0f0f0; }
.horse-checkbox-label input[type="checkbox"] { margin-right: 10px; }
.horse-checkbox-label.selected { border-color: #4caf50; background: #e8f5e9; }
.horse-checkbox-label .waku { display: inline-block; width: 25px; height: 25px; line-height: 25px; text-align: center; border-radius: 3px; margin-right: 8px; font-size: 12px; }
.horse-checkbox-label .jockey { color: #888; margin-left: 10px; font-size: 13px; }
.horse-checkbox-label-small { display: block; padding: 5px; margin: 3px 0; background: white; border-radius: 3px; cursor: pointer; border: 2px solid transparent; font-size: 13px; }
.horse-checkbox-label-small:hover { background: #f0f0f0; }
.horse-checkbox-label-small.selected { border-color: #4caf50; background: #e8f5e9; }
.horse-checkbox-label-small input[type="checkbox"] { margin-right: 5px; }
.selection-info { margin-top: 10px; padding: 10px; background: #fff3cd; border-radius: 5px; font-weight: bold; color: #856404; }
.bet-input-type { display: none; }
</style>
</head>
<body>
<div class="container">
<div class="header">
<h1>üìù ‰∫àÊÉ≥ÂÖ•Âäõ - <%= race.race_name %></h1>
<p>„É¶„Éº„Ç∂„Éº: <%= user.display_name %></p>
<a href="/races/<%= race.race_id %>" class="back-link">‚Üê Âá∫È¶¨Ë°®„Å´Êàª„Çã</a>
</div>
<div class="section">
<h2>üéØ Âç∞„ÇíÂÖ•Âäõ</h2>
<form id="marks-form">
<table>
<thead><tr><th>Êû†</th><th>È¶¨Áï™</th><th>È¶¨Âêç</th><th>È®éÊâã</th><th>Âç∞</th></tr></thead>
<tbody>
<% const existingMarks = {}; predictions.forEach(p => { existingMarks[p.umaban] = p.mark; }); %>
<% horses.forEach(horse => { %>
<tr>
<td><div class="waku waku-<%= horse.waku %>"><%= horse.waku %></div></td>
<td><strong><%= horse.umaban %></strong></td>
<td><%= horse.horse_name %></td>
<td><%= horse.jockey %></td>
<td><select name="mark_<%= horse.umaban %>" class="mark-select">
<option value="">-</option>
<option value="‚óé" <%= existingMarks[horse.umaban] === '‚óé' ? 'selected' : '' %>>‚óé</option>
<option value="‚óã" <%= existingMarks[horse.umaban] === '‚óã' ? 'selected' : '' %>>‚óã</option>
<option value="‚ñ≤" <%= existingMarks[horse.umaban] === '‚ñ≤' ? 'selected' : '' %>>‚ñ≤</option>
<option value="‚ñ≥" <%= existingMarks[horse.umaban] === '‚ñ≥' ? 'selected' : '' %>>‚ñ≥</option>
<option value="‚òÜ" <%= existingMarks[horse.umaban] === '‚òÜ' ? 'selected' : '' %>>‚òÜ</option>
</select></td>
</tr>
<% }); %>
</tbody>
</table>
<button type="submit" class="btn btn-success" style="margin-top: 15px;">Âç∞„Çí‰øùÂ≠ò</button>
</form>
</div>
